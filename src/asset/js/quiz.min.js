function Quiz(e,t){let h=document.querySelector(e),L=t.steps,q=t.finishStep,z=0,f={},E={},A=[],y=[];if(h&&L&&L.length){const g=e=>{A=[];var l=e=>f[e],u=e=>{var t="prev"===e?z-1:z+1;L[t]&&(d.style.opacity="0",setTimeout(()=>{d.remove(),z=t,g(z)},300))};let t=L[e],i=t.title,a="Шаг "+(e+1)+"/"+L.length,n=t.elements,d=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),m=document.createElement("div"),o=document.createElement("div"),p=document.createElement("div"),b=document.createElement("div"),v,_;if(Array.from(t.elements).forEach(e=>{A.push(e.name)}),d.classList.add("quiz-form"),d.style.opacity="0",s.classList.add("quiz-form__header"),r.classList.add("quiz-form__title"),r.innerText=i,c.classList.add("quiz-form__step"),c.innerText=a,m.classList.add("quiz-form__body"),o.classList.add("quiz-form__elements"),p.classList.add("quiz-form__footer"),b.classList.add("quiz-form__buttons"),"object"==typeof n&&n.length)for(let t=0;t<n.length;t++){let e;switch(!0){case"radio"===n[t].type:e=((n,d)=>{let s=document.createElement("div");s.classList.add("quiz-radio"),3<d.length&&s.classList.add("quiz-radio_two-columns");for(let a=0;a<d.length;a++){let e=document.createElement("div"),t=document.createElement("input"),i=document.createElement("label");e.classList.add("quiz-radio__item"),t.setAttribute("type","radio"),t.setAttribute("name",n),t.setAttribute("value",d[a]),t.setAttribute("id",n+"-"+a),t.classList.add("quiz-radio__input"),f[n]===d[a]&&(t.checked=!0),t.addEventListener("change",()=>{f[n]=d[a],A.every(l)&&_&&(_.removeAttribute("disabled"),1===A.length&&u())}),i.classList.add("quiz-radio__label"),i.setAttribute("for",n+"-"+a),i.innerText=d[a],e.appendChild(t),e.appendChild(i),s.appendChild(e)}return s})(n[t].name,n[t].values);break;case"select"===n[t].type:e=((i,e,a)=>{let t=document.createElement("div");t.classList.add("quiz-select");let n=document.createElement("label");n.setAttribute("for",i),n.classList.add("quiz-select__label"),n.innerText=e;let d=document.createElement("select");d.classList.add("quiz-select__select"),d.setAttribute("name",i),d.setAttribute("id",i);for(let t=0;t<a.length;t++){let e=document.createElement("option");e.value=a[t],e.innerText=a[t],a[t]===f[i]&&(e.setAttribute("selected","selected"),a[t]&&d.classList.add("quiz-select__select_active")),d.appendChild(e)}return d.addEventListener("change",()=>{f[i]=d.value,A.every(l)&&_?(d.classList.add("quiz-select__select_active"),_.removeAttribute("disabled")):(d.classList.remove("quiz-select__select_active"),_.setAttribute("disabled","disabled"))}),t.appendChild(n),t.appendChild(d),t})(n[t].name,n[t].label,n[t].values);break;case"finishStep"===n[t].type:e=(()=>{y=[];const n=document.createElement("button");var d=e=>E[e];for(let e=0;e<q.length;e++)q[e].impotent&&y.push(q[e].name);var e=Object.values(f);let t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","answers"),t.setAttribute("value",JSON.stringify(e)),h.appendChild(t);for(let a=0;a<q.length;a++)if("input"===q[a].object){let e=document.createElement("div"),t=document.createElement("input"),i=document.createElement("label");e.classList.add("quiz-input"),t.setAttribute("type",q[a].type),t.setAttribute("name",q[a].name),t.setAttribute("id",q[a].name),t.classList.add("quiz-input__input"),i.setAttribute("for",q[a].name),i.classList.add("quiz-input__label"),i.innerText=q[a].label,t.addEventListener("input",()=>{0<t.value.length?(t.classList.add("quiz-input__input_active"),i.classList.add("quiz-input__label_active"),E[q[a].name]=t.value):(t.classList.remove("quiz-input__input_active"),i.classList.remove("quiz-input__label_active"),E[q[a].name]=""),y.every(d)?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled")}),e.appendChild(t),e.appendChild(i),o.appendChild(e)}else if("submit"===q[a].object)n.setAttribute("type","submit"),n.setAttribute("name",q[a].name),n.setAttribute("title",q[a].text),n.classList.add("quiz-button","quiz-button_submit"),n.innerText=q[a].text,n.setAttribute("disabled","disabled"),b.appendChild(n);else if("agreed"===q[a].object){let e=document.createElement("div");e.classList.add("quiz-agreed"),e.innerHTML=q[a].text,p.appendChild(e)}})()}e&&"finishStep"!==n[t].type&&o.appendChild(e)}L[z+1]&&z+1<L.length&&(_=document.createElement("button"),A.every(l)||_.setAttribute("disabled","disabled"),_.classList.add("quiz-button","quiz-button_next"),_.innerText="Далее",_.addEventListener("click",e=>{e.preventDefault(),u()})),0<z&&z+1<L.length&&(v=document.createElement("button"),v.classList.add("quiz-button","quiz-button_not-important","quiz-button_prev"),v.innerText="Назад",v.addEventListener("click",e=>{e.preventDefault(),u("prev")})),(v||_)&&(v&&b.appendChild(v),_&&b.appendChild(_)),s.append(r,c),m.appendChild(o),d.append(s,m),b&&p.prepend(b),p&&d.appendChild(p),h.appendChild(d),setTimeout(()=>{d.style.opacity="1"},100)};g(z),h.addEventListener("submit",e=>{e.preventDefault(),t.executeFunction()})}}